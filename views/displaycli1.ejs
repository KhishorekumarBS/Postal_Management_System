<html>
<head>
    <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script
  src="https://code.jquery.com/jquery-3.2.1.js"
  integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
  crossorigin="anonymous"></script>

  <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<link href='https://fonts.googleapis.com/css?family=Abel' rel='stylesheet'>
  <link href='https://fonts.googleapis.com/css?family=Noticia Text' rel='stylesheet'>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<style type="text/css">
  
.popup {
    width:100%;
    height:100%;
    display:none;
    position:fixed;
    top:0px;
    left:0px;
    background:rgba(0,0,0,0.75);
}
 
/* Inner */
.popup-inner {
    padding:40px;
    position:absolute;
    top:50%;
    left:50%;
    -webkit-transform:translate(-50%, -50%);
    transform:translate(-50%, -50%);
    box-shadow:0px 2px 6px rgba(0,0,0,1);
    border-radius:3px;
    background:#fff;
}
 
/* Close Button */
.popup-close {
    width:30px;
    height:30px;
    padding-top:4px;
    display:inline-block;
    position:absolute;
    top:0px;
    right:0px;
    transition:ease 0.25s all;
    -webkit-transform:translate(50%, -50%);
    transform:translate(50%, -50%);
    border-radius:1000px;
    background:rgba(0,0,0,0.8);
    font-family:Arial, Sans-Serif;
    font-size:20px;
    text-align:center;
    line-height:100%;
    color:#fff;
}
 
.popup-close:hover {
    -webkit-transform:translate(50%, -50%) rotate(180deg);
    transform:translate(50%, -50%) rotate(180deg);
    background:rgba(0,0,0,1);
    text-decoration:none;
}
.dialogdemoBasicUsage #popupContainer {
  position: relative; }

.dialogdemoBasicUsage .footer {
  width: 100%;
  text-align: center;
  margin-left: 20px; }

.dialogdemoBasicUsage .footer, .dialogdemoBasicUsage .footer > code {
  font-size: 0.8em;
  margin-top: 50px; }

.dialogdemoBasicUsage button {
  width: 200px; }

.dialogdemoBasicUsage div#status {
  color: #c60008; }

.dialogdemoBasicUsage .dialog-demo-prerendered md-checkbox {
  margin-bottom: 0; }

</style>
</head>
<body>
<div class="container" id="viewdiv">
<br><br><br>
    <div id="verify_div">
    <div class="form-inline">
      Verify :
        <input class="form-control" type="text" placeholder="Enter id" id="verify_key" required> 
        <button id="verify_id_btn" class="btn btn-primary">Submit</button>
    </div>
  </div>

    <div class="container" style="overflow-x:auto;">
        <table id="mytable" class="table table-bordered table-hover">
          <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">id</th>
                <th scope="col">Date</th>
                <th scope="col">Department</th>
                <th scope="col">Subject</th>
                 <th scope="col">Sender</th>
                <th scope="col">DD No.</th>
                <th scope="col">Amount</th>
               </tr>
          </thead>
          <tbody>
          </tbody>
        </table>

</div>

  <div class="popup" data-popup="popup-1">
    <div class="popup-inner">
      <div id="stage1">
          <form name="register">
          <div class="container">
            <div class="form-group">
                <label for="exampleInputEmail1">Id</label>
                <input class="form-control" type="text" placeholder="Enter id" id="id" required>
            </div>
            <div class="form-group">
                <label class="my-1 mr-2" for="inlineFormCustomSelectPref">Department</label>
                <select class="form-control" class="custom-select my-1 mr-sm-2" id="dept">
                    <option name="Civil">Civil</option>
                    <option name="Mechanical">Mechanical</option>
                    <option name="Electrical">Electrical</option>
                    <option name="INC">INC</option>
                    <option name="MBA">MBA</option>
                    <option name="SAP">SAP</option>
                    <option name="SnH">SnH</option>
                    <option name="Technology">Technology</option>
                </select>
            </div>
            <div class="form-group">
                <label for="exampleInputPassword1">Subject</label>
                <input class="form-control" type="text" placeholder="Enter Subject" id="sub" required>
            </div>
               <div class="form-group">
                <label for="exampleInputPassword1">Sender</label>
                <input class="form-control" type="text" placeholder="Enter Sender" id="dh" required>
            </div>
              <div class="form-group">
                <label for="exampleInputPassword1">DD Number</label>
                <input class="form-control" type="text" placeholder="Enter DD Number" id="ddno" required>
            </div>
              <div class="form-group">
                <label for="exampleInputPassword1">DD Amount</label>
                <input class="form-control" type="text" placeholder="Enter Amount" id="amt" required>
            </div>
          
            
          <!--
          <div class="form-group">
            <label class="my-1 mr-2" for="inlineFormCustomSelectPref">Dealing Hand</label>
            <select class="form-control" id="dh">
              <option name="Civil">Civil</option>
              <option name="Mechanical">Mechanical</option>
              <option name="Electrical">Electrical</option>
              <option name="INC">INC</option>
              <option name="MBA">MBA</option>
              <option name="SAP">SAP</option>
              <option name="SnH">SnH</option>
              <option name="Technology">Technology</option>
            </select>
          </div><br>-->
          <center><button id="registerbtn" class="btn btn-primary">Insert</button></center>
        </form>
        <a class="popup-close" data-popup-close="popup-1" href="#">x</a>
    </div>
    </form>
    </div>

      <div id="stage2">
          <div class="container">
            <div class="form-group">
                <label for="exampleInputEmail1">Id</label>
                <input class="form-control" type="text" placeholder="Enter id" id="2id" readonly>
            </div>
            <div class="form-group">
                <label class="my-1 mr-2" for="inlineFormCustomSelectPref">Department</label>
                <select class="form-control" class="custom-select my-1 mr-sm-2" id="2dept">
                    <option name="Civil">Civil</option>
                    <option name="Mechanical">Mechanical</option>
                    <option name="Electrical">Electrical</option>
                    <option name="INC">INC</option>
                    <option name="MBA">MBA</option>
                    <option name="SAP">SAP</option>
                    <option name="SnH">SnH</option>
                    <option name="Technology">Technology</option>
                </select>
            </div>
            <div class="form-group">
                <label for="exampleInputPassword1">Subject</label>
                <input class="form-control" type="text" placeholder="Enter Subject" id="2sub" required>
            </div>
              <div class="form-group">
                <label for="exampleInputPassword1">Sender</label>
                <input class="form-control" type="text" placeholder="Enter Sender" id="2dh" required>
            </div>
              <div class="form-group">
                <label for="exampleInputPassword1">DD Number</label>
                <input class="form-control" type="text" placeholder="Enter DD Number" id="2ddno" required>
            </div>
              <div class="form-group">
                <label for="exampleInputPassword1">DD Amount</label>
                <input class="form-control" type="text" placeholder="Enter Amount" id="2amt" required>
            </div>
          <!--
          <div class="form-group">
            <label class="my-1 mr-2" for="inlineFormCustomSelectPref">Dealing Hand</label>
            <select class="form-control" id="2dh">
              <option name="Civil">Civil</option>
              <option name="Mechanical">Mechanical</option>
              <option name="Electrical">Electrical</option>
              <option name="INC">INC</option>
              <option name="MBA">MBA</option>
              <option name="SAP">SAP</option>
              <option name="SnH">SnH</option>
              <option name="Technology">Technology</option>
            </select>
          </div><br>-->
          <center><button id="update_registerbtn" class="btn btn-primary">Update</button></center>
        <a class="popup-close" data-popup-close="popup-2" href="#">x</a>
    </div>
  </div>
</div>


<script type="text/javascript">
    fetchall();
function fetchall()
{
              $.ajax({
                  type: "POST",
                  url: "/fetch_by_dept",
                  success: function(docs) {
                   populates(docs);
                },
                error: function(jqXHR, textStatus, err) {
                  alert('text status '+textStatus+', err '+err)
                }
            });
}

function populates(docs)
{
  $('#mytable tr').not(':first').remove();
      var html = '';
      $.each(docs, function (i) {
          var num=i+1;
          var stockfile,flag;
          html += '<tr><td>' + num
           + '</td><td>' + eval(JSON.stringify(docs[i]._id))
           + '</td><td>' + eval(JSON.stringify(docs[i].displaydate))
           + '</td><td>' + eval(JSON.stringify(docs[i].department))
           + '</td><td>' + eval(JSON.stringify(docs[i].sender))
           + '</td><td>' + eval(JSON.stringify(docs[i].subject))
           + '</td><td>' + eval(JSON.stringify(docs[i].ddnum))
           + '</td><td>' + eval(JSON.stringify(docs[i].amount))
           /*+ '</td><td>'+stockfile+'</td><td>'+backup+'</td><td>'*/
        });
  $('#mytable tr').first().after(html);
}

 $("#verify_id_btn").click(function(event){   
              var txtbox = document.getElementById("verify_key");
              $.ajax({
                  type: "POST",
                  url: "/verify",
                  data:{ key: txtbox.value },
                  success: function(docs) {
                    alert("Verified");
                    fetchall();
                },
                error: function(jqXHR, textStatus, err) {
                  alert('text status '+textStatus+', err '+err)
                }
            }); 
            }); 


</script>
</body>
</html>